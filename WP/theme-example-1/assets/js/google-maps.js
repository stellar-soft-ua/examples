var marker,ajaxurl="/wp-admin/admin-ajax.php",allMarkers=[],map=new google.maps.Map(document.getElementById("map"),{center:new google.maps.LatLng(0,0),zoom:2});function initMap(){var e=[],t=[],r=[];jQuery(".map-container__item").each(function(a){e.push({lat:parseFloat(jQuery(".latitude",this).val()),lng:parseFloat(jQuery(".longitude",this).val()),id:jQuery(".marker_id",this).val()}),t.push(jQuery(".map-container__item-title",this).text()),r.push(jQuery(".key_words",this).val())});for(var a=0;a<e.length;a++)(marker=new google.maps.Marker({position:{lat:e[a].lat,lng:e[a].lng},map:map,title:t[a],id:e[a].id,keyWord:r[a]})).addListener("click",function(){map.setZoom(5),map.setCenter(this.getPosition()),searchOnPanClick(this.keyWord)}),allMarkers.push(marker)}function onItemClick(e){var t=jQuery(e).children(".marker_id").val(),r=parseFloat(jQuery(e).children(".latitude").val()),a=parseFloat(jQuery(e).children(".longitude").val());if(!isNaN(r)&&!isNaN(a)){map.setCenter({lat:r,lng:a}),map.setZoom(4);for(var o=0;o<allMarkers.length;o++)allMarkers[o].setAnimation(null);for(o=0;o<allMarkers.length;o++)t===allMarkers[o].id&&allMarkers[o].setAnimation(google.maps.Animation.BOUNCE)}jQuery(".clear-icon").show()}function check_value(){const e=jQuery("#search-locations").val();jQuery(".clear-icon").toggle(""!==e)}function searchItems(){jQuery("#search-locations").bind("enterKey",function(e){searchLocations()}),jQuery("#search-locations").keyup(function(e){13===e.keyCode&&(jQuery(this).trigger("enterKey"),jQuery(".location-selector_region-item").removeClass("selected-region"),jQuery(".location-selector_region-item").removeClass("selected-state"),jQuery(".location-selector_state").html(""))})}function searchLocations(){jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"load-search-map-locations",search:jQuery("#search-locations").val(),category:jQuery(".posts-category").val()},success:function(e){return jQuery.trim(e)?(removeAllmarkers(),allMarkers=[],jQuery(".map-items-block").html("").html(e),jQuery(".map-container__item-title").wrapInTag({tag:"b",words:[jQuery("#search-locations").val()]}),jQuery(".map-container__item-name").wrapInTag({tag:"b",words:[jQuery("#search-locations").val()]}),initMap()):jQuery(".map-items-block").html('<h3 style="margin: 10px;">No matches found</h3>'),!1}}),check_value()}function regionClick(e){jQuery(".location-selector_region-item").removeClass("selected-region"),jQuery(e).toggleClass("selected-region"),jQuery(".location-selector_state").html("");for(var t=regions[jQuery(e).text()],r=0;r<t.length;r++)jQuery(".location-selector_state").append("<div onclick='stateClick(this)'id='"+r+"'class='location-selector_region-item'>"+t[r]+"</div>");jQuery(".clear-icon").show()}function stateClick(e){jQuery(".location-selector_region-item").removeClass("selected-state"),jQuery(e).toggleClass("selected-state"),jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"load-search-map-locations",search:jQuery(e).text(),category:jQuery(".posts-category").val()},success:function(e){return jQuery.trim(e)?(removeAllmarkers(),allMarkers=[],jQuery(".map-items-block").html("").html(e),initMap(),map.setZoom(2)):(jQuery(".map-items-block").html('<h3 style="margin: 10px; background-color: transparent">No matches found</h3>'),removeAllmarkers(),allMarkers=[]),!1}}),jQuery(".clear-icon").show()}function searchOnPanClick(e){jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"load-search-map-locations",search:e,category:jQuery(".posts-category").val()},success:function(e){return jQuery.trim(e)?(removeAllmarkers(),allMarkers=[],jQuery(".map-items-block").html("").html(e),initMap()):(jQuery(".map-items-block").html('<h3 style="margin: 10px; background-color: transparent">No matches found</h3>'),removeAllmarkers(),allMarkers=[]),!1}}),jQuery(".clear-icon").show(),findRegionAndSelect(e)}function findRegionAndSelect(e){const t=Object.keys(regions),r=Object.values(regions);for(var a="",o="",l=null,n=0;n<r.length;n++)if(a=r[n].find(function(t,r){return!!new RegExp("\\b"+t+"\\b").test(e)&&(l=r,t)})){o=t[n];break}if(jQuery(".location-selector_region-item").each(function(){jQuery(this).text()===o&&jQuery(this).click()}),jQuery(".location-selector_region-item").each(function(){jQuery(this).text()===a&&jQuery(this).addClass("selected-state")}),null!==l){var s=document.getElementById(l).offsetTop;document.getElementById("state-selector").scrollTop=s}}function removeAllmarkers(){for(var e=0;e<allMarkers.length;e++)allMarkers[e].setMap(null)}jQuery(document).ready(function(){initMap(),searchItems(),jQuery(".search-icon").click(function(e){e.preventDefault(),jQuery("#search-locations").trigger("enterKey"),jQuery(".location-selector_region-item").removeClass("selected-region"),jQuery(".location-selector_region-item").removeClass("selected-state"),jQuery(".location-selector_state").html("")}),jQuery(".clear-icon").click(function(e){e.preventDefault(),jQuery(".location-selector_region-item").removeClass("selected-region"),jQuery(".location-selector_region-item").removeClass("selected-state"),jQuery(".location-selector_state").html(""),jQuery("#search-locations").val(""),searchLocations(),map.setZoom(2),map.setCenter({lat:0,lng:0})})}),jQuery.fn.wrapInTag=function(e){var t=e.tag||"strong",r=e.words||"",a=RegExp(r.join("|"),"gi"),o="<"+t+">$&</"+t+">";if(r[0].length>0)return this.html(function(){return jQuery(this).text().replace(a,o)})};